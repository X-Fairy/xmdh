(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/update/update"],{"13db":function(t,e,n){"use strict";n.r(e);var a=n("be6e"),o=n("cf70");for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);n("3ac2");var i=n("2877"),l=Object(i["a"])(o["default"],a["a"],a["b"],!1,null,null,null);e["default"]=l.exports},"3ac2":function(t,e,n){"use strict";var a=n("cef5"),o=n.n(a);o.a},"3dd7":function(t,e,n){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n("3d3b"));function s(t){return t&&t.__esModule?t:{default:t}}var i={title:"发现新版本",downcenter:[],server_version:0,ProgressHdid:!1,downloadProgress:0},l={data:function(){return{info:"正在加载",Minfo:"未知",Mtip:"",updateInfo:"无",latest:null,packgeSize:null,packgePath:null,downloadTask:null,buttonLoading:!1,installed:!1,startProgress:!1,currentIsLatest:!0,appURL:"",iosLink:"https://itunes.apple.com/cn/app/XIMIVOGUE/id1256241115?mt=8&l=zh",mvc:{title:"发现新版本",downcenter:[],server_version:0,ProgressHdid:!1,downloadProgress:0}}},onLoad:function(t){this.loadAndroid()},onReady:function(t){},onShow:function(){!0===this.installed&&this.packgePath&&(this.installed=!1,this.haveDownloaded())},onUnload:function(){this.downloadTask&&(this.closeTask(),this.showToast("更新被取消"),t.navigateBack({delta:1}))},onPullDownRefresh:function(){t.stopPullDownRefresh()},methods:{loadAndroid:function(){o.default.load(this.$t("index").loadmsg);var e=this;plus.runtime.getProperty(plus.runtime.appid,function(n){var a="";a="android"==plus.os.name.toLowerCase()?1:2;var o={version:n.version,type:a};e.$ajax.Version(o).then(function(n){if(i.server_version=n.server_version,e.appURL=n.app_link,0!=n.update_note.length)i.downcenter=n.update_note.split("/");else{var a=[{0:"暂无"}];i.downcenter=a}e.mvc=i,t.hideLoading()})})},showToast:function(e){t.showToast({title:e,duration:3e3,icon:"none"})},goback:function(){t.navigateBack({delta:1})},installPackge:function(){var e=this;plus.runtime.install(this.packgePath,{force:!0}),this.installed=!0,t.setStorage({key:"updated",data:{completed:!0,packgePath:this.packgePath},success:function(t){console.log(a("成功保存更新记录"," at pages\\update\\update.vue:162"))}}),this.packgePath.match(RegExp(/.wgt/))&&(this.installed=!1,t.showModal({title:"提示",cancelText:e.$t("index").cancel,confirmText:e.$t("index").confirm,content:"应用将重启以完成更新",showCancel:!1,complete:function(){plus.runtime.restart()}}))},haveDownloaded:function(){var e=this,n=this;t.showModal({title:"更新尚未完成",content:"您已下载更新包，但是还没有完成安装，请问是否要继续安装更新包呢？",cancelText:n.$t("index").cancel,confirmText:n.$t("index").confirm,success:function(n){n.confirm?e.installPackge():n.cancel&&(e.showToast("更新被取消"),t.navigateBack({delta:1}))}})},closeTask:function(){this.downloadTask.abort(),this.downloadTask=null,this.startProgress=!1},createTask:function(e){var n=this,a=this;i.downloadProgress=0,this.startProgress=!0,this.downloadTask=t.downloadFile({url:e,success:function(e){200===e.statusCode&&t.saveFile({tempFilePath:e.tempFilePath,success:function(t){n.packgePath=t.savedFilePath,n.installPackge(),n.closeTask()}})}}),this.downloadTask.onProgressUpdate(function(t){i.downloadProgress=t.progress,a.mvc=i})},handleUpdate:function(){var t=this;"android"==plus.os.name.toLowerCase()?(i.ProgressHdid=!0,t.createTask(t.appURL)):plus.runtime.openURL(t.iosLink),t.mvc=i}}};e.default=l}).call(this,n("6e42")["default"],n("0de9")["default"])},be6e:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return o})},cef5:function(t,e,n){},cf70:function(t,e,n){"use strict";n.r(e);var a=n("3dd7"),o=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);e["default"]=o.a},ef99:function(t,e,n){"use strict";(function(t){n("d471"),n("921b");a(n("66fd"));var e=a(n("13db"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])}},[["ef99","common/runtime","common/vendor"]]]);
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/update/update"],{"0e90":function(t,e,n){},"110c":function(t,e,n){"use strict";n.r(e);var o=n("9c82"),a=n("ff98");for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);n("4687");var i,c=n("f0c5"),r=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);e["default"]=r.exports},1992:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("0421"));function a(t){return t&&t.__esModule?t:{default:t}}var s={title:"发现新版本",downcenter:[],server_version:0,ProgressHdid:!1,downloadProgress:0},i={data:function(){return{info:"正在加载",Minfo:"未知",Mtip:"",updateInfo:"无",latest:null,packgeSize:null,packgePath:null,downloadTask:null,buttonLoading:!1,installed:!1,startProgress:!1,currentIsLatest:!0,appURL:"",iosLink:"https://itunes.apple.com/cn/app/XIMIVOGUE/id1256241115?mt=8&l=zh",mvc:{title:"发现新版本",downcenter:[],server_version:0,ProgressHdid:!1,downloadProgress:0}}},onLoad:function(t){this.loadAndroid()},onReady:function(t){},onShow:function(){!0===this.installed&&this.packgePath&&(this.installed=!1,this.haveDownloaded())},onUnload:function(){this.downloadTask&&(this.closeTask(),this.showToast("更新被取消"),t.navigateBack({delta:1}))},onPullDownRefresh:function(){t.stopPullDownRefresh()},methods:{loadAndroid:function(){o.default.load(this.$t("index").loadmsg);var e=this;plus.runtime.getProperty(plus.runtime.appid,(function(n){var o="";o="android"==plus.os.name.toLowerCase()?1:2;var a={version:n.version,type:o};e.$ajax.Version(a).then((function(n){if(s.server_version=n.server_version,e.appURL=n.app_link,0!=n.update_note.length)s.downcenter=n.update_note.split("/");else{var o=[{0:"暂无"}];s.downcenter=o}e.mvc=s,t.hideLoading()}))}))},showToast:function(e){t.showToast({title:e,duration:3e3,icon:"none"})},goback:function(){t.navigateBack({delta:1})},installPackge:function(){var e=this;plus.runtime.install(this.packgePath,{force:!0}),this.installed=!0,t.setStorage({key:"updated",data:{completed:!0,packgePath:this.packgePath},success:function(t){console.log("成功保存更新记录")}}),this.packgePath.match(RegExp(/.wgt/))&&(this.installed=!1,t.showModal({title:"提示",cancelText:e.$t("index").cancel,confirmText:e.$t("index").confirm,content:"应用将重启以完成更新",showCancel:!1,complete:function(){plus.runtime.restart()}}))},haveDownloaded:function(){var e=this,n=this;t.showModal({title:"更新尚未完成",content:"您已下载更新包，但是还没有完成安装，请问是否要继续安装更新包呢？",cancelText:n.$t("index").cancel,confirmText:n.$t("index").confirm,success:function(n){n.confirm?e.installPackge():n.cancel&&(e.showToast("更新被取消"),t.navigateBack({delta:1}))}})},closeTask:function(){this.downloadTask.abort(),this.downloadTask=null,this.startProgress=!1},createTask:function(e){var n=this,o=this;s.downloadProgress=0,this.startProgress=!0,this.downloadTask=t.downloadFile({url:e,success:function(e){200===e.statusCode&&t.saveFile({tempFilePath:e.tempFilePath,success:function(t){n.packgePath=t.savedFilePath,n.installPackge(),n.closeTask()}})}}),this.downloadTask.onProgressUpdate((function(t){s.downloadProgress=t.progress,o.mvc=s}))},handleUpdate:function(){var t=this;"android"==plus.os.name.toLowerCase()?(s.ProgressHdid=!0,t.createTask(t.appURL)):plus.runtime.openURL(t.iosLink),t.mvc=s}}};e.default=i}).call(this,n("543d")["default"])},4687:function(t,e,n){"use strict";var o=n("0e90"),a=n.n(o);a.a},"9c82":function(t,e,n){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}))},b1c2:function(t,e,n){"use strict";(function(t){n("3f5c"),n("921b");o(n("66fd"));var e=o(n("110c"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},ff98:function(t,e,n){"use strict";n.r(e);var o=n("1992"),a=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=a.a}},[["b1c2","common/runtime","common/vendor"]]]);